<!DOCTYPE html>
<html lang="en">

<footer class="footer" onload="checkSubscription()">
  <div>
    <p class="footer-top">Built using:</p>
    <a href="https://romanzolotarev.com/ssg.html" class="footer-ssg"><b>SSG</b> by Roman Zolotarev</a>
  </div>
  <div>
     <form onsubmit="subscribe()" class="subscription-box" id="sub-form">
       <input type="text" id="name" placeholder="name...">
       <input type="email" id="email" placeholder="email address...">
       <input id="subscribe-button"  type="submit" value="Subscribe">
     </form> 
  </div>
  <div>
    <img src="./assets/tick.svg" id="subscribed-tick" title="you're subscribed!" >
  </div>
</footer>
<script type="text/javascript">
   (function checkSubscription() {
      const subscribed = localStorage.getItem('subscribed');
      if (subscribed) {
         const form = document.getElementById("sub-form");
         form.style.display = "none";
      } else {
         const tick = document.getElementById("subscribed-tick");
         tick.style.display = "none";
      };
   })();
 
   function subscribe() {
      event.preventDefault();
      const name = document.querySelector('#name').value;
      const email = document.querySelector('#email').value;
      const subscriber = { name: name, email: email };
      const options = {
        method: 'POST',
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(subscriber),
      };
      fetch(url, options)
      .then(res => res.json())
      .then(({ subscribed }) => {
         if (subscribed) {
           localStorage.setItem('subscribed', true);
           localStorage.setItem('name', name);
           const form = document.getElementById("sub-form");
           form.style.display = "none";
           
        };
      })
      .catch(err => { console.log(err); });
    };
</script>

</html>
